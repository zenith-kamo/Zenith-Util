// ==UserScript==
// @name         Zenith Util
// @namespace    http://tampermonkey.net/
// @version      2.1
// @description  Modular utilities for wplace.live.
// @author       Zenith
// @match        https://wplace.live/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=wplace.live
// @grant        GM_addStyle
// @grant        GM_setValue
// @grant        GM_getValue
// ==/UserScript==
!function(){"use strict";const e={storageKey:"zenith_util_config_v2",targetContainerSelector:"div.flex.flex-col.items-center.gap-3"},n={gear:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>',back:"<span>‚Üê Back</span>"};GM_addStyle("\n        #zenith-settings-btn {\n            background-color: #2d3748; color: white; border: none; cursor: pointer;\n            transition: transform 0.1s; display: inline-flex; justify-content: center; align-items: center;\n        }\n        #zenith-settings-btn:hover { transform: scale(1.05); }\n\n        #zenith-modal-overlay {\n            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;\n            background: rgba(0, 0, 0, 0.75); z-index: 9999;\n            display: flex; justify-content: center; align-items: center;\n            font-family: 'Segoe UI', sans-serif; backdrop-filter: blur(4px);\n        }\n\n        #zenith-modal-container {\n            width: 850px; height: 600px; background: #1a202c;\n            border-radius: 12px; display: flex; overflow: hidden;\n            box-shadow: 0 20px 50px rgba(0,0,0,0.5); color: #e2e8f0;\n        }\n\n        .zenith-sidebar {\n            width: 220px; background: #2d3748; padding: 20px 0;\n            display: flex; flex-direction: column; flex-shrink: 0;\n        }\n        .zenith-title {\n            padding: 0 24px 24px; font-size: 1.4em; font-weight: bold; color: #63b3ed;\n        }\n        .zenith-nav-item {\n            padding: 14px 24px; cursor: pointer; font-weight: 500; transition: all 0.2s;\n        }\n        .zenith-nav-item:hover { background: #4a5568; }\n        .zenith-nav-item.active {\n            background: #2b6cb0; border-left: 4px solid #90cdf4; color: white;\n        }\n\n        .zenith-content {\n            flex: 1; padding: 30px; overflow-y: auto; position: relative; display: flex; flex-direction: column;\n        }\n        .zenith-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }\n        .zenith-close-btn {\n            background: none; border: none; font-size: 28px; color: #a0aec0; cursor: pointer;\n            position: absolute; top: 15px; right: 25px; line-height: 1;\n        }\n        .zenith-close-btn:hover { color: white; }\n\n        .zenith-search-bar {\n            width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #4a5568;\n            background: #2d3748; color: white; margin-bottom: 24px; font-size: 1em;\n        }\n        .zenith-plugin-grid {\n            display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 20px;\n        }\n        .zenith-module-card {\n            background: #2d3748; border-radius: 8px; padding: 16px;\n            position: relative; border: 1px solid #4a5568;\n            height: 160px; overflow: hidden; display: flex; flex-direction: column;\n            box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n        }\n        .zenith-card-header {\n            display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; z-index: 2;\n        }\n        .zenith-icon-btn {\n            cursor: pointer; color: #a0aec0; padding: 4px; border-radius: 4px; transition: 0.2s;\n        }\n        .zenith-icon-btn:hover { color: #63b3ed; background: rgba(255,255,255,0.05); }\n\n        .zenith-module-title { font-weight: bold; font-size: 1.1em; color: white; margin-bottom: 4px; z-index: 2; }\n        .zenith-module-desc { font-size: 0.85em; color: #cbd5e0; flex-grow: 1; z-index: 2; }\n\n        .zenith-settings-overlay {\n            position: absolute; top: 0; left: 0; width: 100%; height: 100%;\n            background: #2d3748; z-index: 10; padding: 16px;\n            transform: translateY(100%); transition: transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);\n            display: flex; flex-direction: column;\n        }\n        .zenith-settings-overlay.visible { transform: translateY(0); }\n\n        .zenith-overlay-header {\n            display: flex; align-items: center; gap: 8px; border-bottom: 1px solid #4a5568;\n            padding-bottom: 10px; margin-bottom: 10px; flex-shrink: 0;\n        }\n        .zenith-back-link {\n            cursor: pointer; color: #63b3ed; font-size: 0.9em; font-weight: bold;\n        }\n        .zenith-back-link:hover { text-decoration: underline; }\n\n        .zenith-settings-scroll {\n            flex: 1; overflow-y: auto; padding-right: 6px;\n        }\n        .zenith-settings-scroll::-webkit-scrollbar { width: 5px; }\n        .zenith-settings-scroll::-webkit-scrollbar-track { background: transparent; }\n        .zenith-settings-scroll::-webkit-scrollbar-thumb { background: #4a5568; border-radius: 10px; }\n        .zenith-settings-scroll::-webkit-scrollbar-thumb:hover { background: #718096; }\n\n\n        .zenith-setting-row {\n            display: flex; justify-content: space-between; align-items: center;\n            margin-bottom: 12px; font-size: 0.9em; min-height: 28px;\n        }\n        .zenith-label { color: #e2e8f0; }\n        \n        .zenith-input-text, .zenith-input-number {\n            background: #1a202c; border: 1px solid #4a5568; color: white;\n            padding: 4px 8px; border-radius: 4px; font-size: 0.9em; text-align: right;\n        }\n        .zenith-input-text { width: 100px; }\n        .zenith-input-number { width: 70px; }\n        .zenith-input-text:focus, .zenith-input-number:focus { border-color: #63b3ed; outline: none; }\n\n        .zenith-switch { position: relative; display: inline-block; width: 40px; height: 22px; flex-shrink: 0; }\n        .zenith-switch input { opacity: 0; width: 0; height: 0; }\n        .zenith-slider {\n            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;\n            background-color: #4a5568; transition: .3s; border-radius: 34px;\n        }\n        .zenith-slider:before {\n            position: absolute; content: \"\"; height: 16px; width: 16px; left: 3px; bottom: 3px;\n            background-color: white; transition: .3s; border-radius: 50%;\n        }\n        input:checked + .zenith-slider { background-color: #48bb78; }\n        input:checked + .zenith-slider:before { transform: translateX(18px); }\n        .zenith-input-color {\n            -webkit-appearance: none;\n            -moz-appearance: none;\n            appearance: none;\n            width: 40px;\n            height: 24px;\n            background: #1a202c;\n            border: 1px solid #4a5568;\n            border-radius: 4px;\n            cursor: pointer;\n            padding: 2px;\n            flex-shrink: 0;\n        }\n        \n        .zenith-input-color::-webkit-color-swatch-wrapper {\n            padding: 0;\n        }\n        \n        .zenith-input-color::-webkit-color-swatch {\n            border: none;\n            border-radius: 2px;\n        }\n        \n        .zenith-input-color::-moz-color-swatch {\n            border: none;\n            border-radius: 2px;\n        }\n\n        .zenith-input-color:focus {\n            border-color: #63b3ed;\n            outline: none;\n        }\n            .zenith-input-select {\n            background: #1a202c;\n            border: 1px solid #4a5568;\n            color: white;\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 0.9em;\n            cursor: pointer;\n            outline: none;\n            min-width: 100px;\n        }\n        .zenith-input-select:focus {\n            border-color: #63b3ed;\n        }\n        .zenith-input-select option {\n            background: #1a202c;\n            color: white;\n        }\n    ");const t=new class{constructor(){this.plugins=[],this.state=JSON.parse(localStorage.getItem(e.storageKey))||{}}register(e){this.plugins.push(e),this.state[e.id]||(this.state[e.id]={enabled:!1,config:e.defaultConfig||{}})}save(){localStorage.setItem(e.storageKey,JSON.stringify(this.state)),this.applyAll()}applyAll(){this.plugins.forEach((e=>{const n=this.state[e.id];n.enabled&&e.onEnable?e.onEnable(n.config):!n.enabled&&e.onDisable&&e.onDisable()}))}},o={row(e,n){const t=document.createElement("div");t.className="zenith-setting-row";const o=document.createElement("span");return o.className="zenith-label",o.textContent=e,t.append(o,n),t},switch(e,n){const t=document.createElement("label");t.className="zenith-switch";const o=document.createElement("input");o.type="checkbox",o.checked=e,o.onchange=e=>n(e.target.checked);const r=document.createElement("span");return r.className="zenith-slider",t.append(o,r),t},number(e,n){const t=document.createElement("input");return t.type="number",t.className="zenith-input-number",t.value=e,t.onchange=e=>n(parseFloat(e.target.value)),t},text(e,n){const t=document.createElement("input");return t.type="text",t.className="zenith-input-text",t.value=e||"",t.onchange=e=>n(e.target.value),t},color(e,n){const t=document.createElement("input");return t.type="color",t.className="zenith-input-color",t.value=e||"#000000",t.onchange=e=>n(e.target.value),t},select(e,n,t){const o=document.createElement("select");return o.className="zenith-input-select",n.forEach((n=>{const t=document.createElement("option");t.value=n.value,t.textContent=n.label||n.value,n.value===e&&(t.selected=!0),o.appendChild(t)})),o.onchange=e=>t(e.target.value),o}};function r(e){e.innerHTML='\n            <div class="zenith-header"><h2>Plugins</h2></div>\n            <input type="text" class="zenith-search-bar" placeholder="Search plugins..." id="z-search">\n            <div class="zenith-plugin-grid" id="z-grid"></div>\n        ';const r=e.querySelector("#z-grid"),i=e.querySelector("#z-search"),l=(e="")=>{r.innerHTML="",t.plugins.forEach((i=>{if(!i.name.toLowerCase().includes(e.toLowerCase()))return;const l=t.state[i.id],a=document.createElement("div");a.className="zenith-module-card",a.innerHTML=`\n                    <div class="zenith-card-header">\n                        <div class="zenith-icon-btn gear-btn" title="Settings">${n.gear}</div>\n                        <div class="toggle-container"></div>\n                    </div>\n                    <div class="zenith-module-title">${i.name}</div>\n                    <div class="zenith-module-desc">${i.description}</div>\n                    \n                    <div class="zenith-settings-overlay">\n                        <div class="zenith-overlay-header">\n                            <span class="zenith-back-link">‚Üê Back</span>\n                            <span style="font-size:0.9em; color:#a0aec0;">| ${i.name} Settings</span>\n                        </div>\n                        <div class="zenith-settings-scroll"></div>\n                    </div>\n                `;const s=o.switch(l.enabled,(e=>{l.enabled=e,t.save()}));a.querySelector(".toggle-container").appendChild(s);const c=a.querySelector(".zenith-settings-overlay"),d=a.querySelector(".zenith-settings-scroll"),p=a.querySelector(".gear-btn"),u=a.querySelector(".zenith-back-link");if(p.onclick=()=>c.classList.add("visible"),u.onclick=()=>c.classList.remove("visible"),i.renderSettings){const e=i.renderSettings(l.config,((e,n)=>{l.config[e]=n,t.save()}));d.appendChild(e)}else d.innerHTML='<div style="text-align:center; padding-top:20px; color:#718096;">No settings available</div>';r.appendChild(a)}))};l(),i.oninput=e=>l(e.target.value)}function i(n){n.innerHTML='\n            <div class="zenith-header"><h2>Import / Export</h2></div>\n            <p style="margin-bottom:10px; color:#cbd5e0;">Backup or restore your configuration JSON.</p>\n            <textarea style="width:100%; height:200px; background:#1a202c; color:white; border:1px solid #4a5568; padding:10px; border-radius:6px; font-family:monospace;" id="z-io"></textarea>\n            <div style="margin-top:15px; display:flex; gap:10px;">\n                <button class="btn btn-sm" id="z-exp" style="background:#48bb78; color:white; border:none; padding:8px 16px; border-radius:4px; cursor:pointer;">Export</button>\n                <button class="btn btn-sm" id="z-imp" style="background:#4299e1; color:white; border:none; padding:8px 16px; border-radius:4px; cursor:pointer;">Import</button>\n            </div>\n        ';const o=n.querySelector("#z-io");n.querySelector("#z-exp").onclick=()=>{o.value=localStorage.getItem(e.storageKey)},n.querySelector("#z-imp").onclick=()=>{try{const n=JSON.parse(o.value);localStorage.setItem(e.storageKey,JSON.stringify(n)),t.state=n,t.applyAll(),alert("Config imported successfully!")}catch(e){alert("Invalid JSON.")}}}function l(){if(document.getElementById("zenith-modal-overlay"))return;const e=document.createElement("div");e.id="zenith-modal-overlay";const n=document.createElement("div");n.id="zenith-modal-container";const t=document.createElement("div");t.className="zenith-sidebar",t.innerHTML='<div class="zenith-title">Zenith Util</div>';const o=document.createElement("div");o.className="zenith-content";const l=document.createElement("button");l.className="zenith-close-btn",l.innerHTML="&times;",l.onclick=()=>e.remove(),o.appendChild(l);const a=[{id:"plugins",label:"Plugins",render:r},{id:"impexp",label:"Import/Export",render:i}];let s="plugins";const c=()=>{t.querySelectorAll(".zenith-nav-item").forEach((e=>e.remove())),a.forEach((e=>{const n=document.createElement("div");n.className="zenith-nav-item "+(s===e.id?"active":""),n.textContent=e.label,n.onclick=()=>{for(s=e.id,c();o.childNodes.length>1;)o.removeChild(o.lastChild);e.render(o)},t.appendChild(n)}))};n.append(t,o),e.appendChild(n),document.body.appendChild(e),c(),a[0].render(o),e.addEventListener("click",(n=>{n.target===e&&e.remove()}))}function a(){const t=document.querySelector(e.targetContainerSelector);if(t&&!document.getElementById("zenith-settings-btn")){const e=document.createElement("button");e.id="zenith-settings-btn",e.className="btn btn-square",e.title="Zenith Settings",e.innerHTML=n.gear,e.onclick=l,t.appendChild(e),console.log("[Zenith Util] Button injected.")}}function s(){a(),t.applyAll();new MutationObserver((e=>{a()})).observe(document.body,{childList:!0,subtree:!0})}t.register({id:"no_ui",name:"No UI",description:"Remove cluttered UI elements.",defaultConfig:{noZoomText:!1,noToast:!1},observer:null,renderSettings:(e,n)=>{const t=document.createElement("div");return t.appendChild(o.row('No "Zoom in to see pixels"',o.switch(e.noZoomText,(e=>n("noZoomText",e))))),t.appendChild(o.row("No Toast Notifications",o.switch(e.noToast,(e=>n("noToast",e))))),t},onEnable:e=>{const n=()=>{if(!e.noZoomText)return;const n=document.querySelector("button.btn.sm\\:btn-lg.duration.text-nowrap.text-xs.transition-opacity.sm\\:text-base");n&&(n.style.display="none")},o=()=>{if(!e.noToast)return;const n=document.querySelector('section[aria-label="Notifications alt+T"]');if(n){const e=n.querySelector("ol");e&&(e.style.display="none")}};n(),o();const r=t.plugins.find((e=>"no_ui"===e.id));r.observer||(r.observer=new MutationObserver((()=>{n(),o()})),r.observer.observe(document.body,{childList:!0,subtree:!0}))},onDisable:()=>{const e=t.plugins.find((e=>"no_ui"===e.id));e.observer&&(e.observer.disconnect(),e.observer=null);const n=document.querySelector("button.btn.sm\\:btn-lg.duration.text-nowrap.text-xs.transition-opacity.sm\\:text-base");n&&(n.style.display="");const o=document.querySelector('section[aria-label="Notifications alt+T"]');if(o){const e=o.querySelector("ol");e&&(e.style.display="")}}}),t.register({id:"change_color",name:"Change Color",description:"Customize theme colors.",defaultConfig:{buttonColor:"#ffffff",buttonBackgroundColor:"#f2f7fe",primaryButtonColor:"#0069ff",primaryFontColor:"#ffffff",levelColor:"#463aa2",uiBackgroundColor:"#ffffff",uiSecondaryBackgroundColor:"#e3e9f4"},renderSettings:(e,n)=>{const t=document.createElement("div");return t.appendChild(o.row("Button Color",o.color(e.buttonColor,(e=>n("buttonColor",e))))),t.appendChild(o.row("Button Background Color",o.color(e.buttonBackgroundColor,(e=>n("buttonBackgroundColor",e))))),t.appendChild(o.row("Primary Button Color",o.color(e.primaryButtonColor,(e=>n("primaryButtonColor",e))))),t.appendChild(o.row("Primary Font Color",o.color(e.primaryFontColor,(e=>n("primaryFontColor",e))))),t.appendChild(o.row("Level Color",o.color(e.levelColor,(e=>n("levelColor",e))))),t.appendChild(o.row("UI Background Color",o.color(e.uiBackgroundColor,(e=>n("uiBackgroundColor",e))))),t.appendChild(o.row("UI Secondary Background Color",o.color(e.uiSecondaryBackgroundColor,(e=>n("uiSecondaryBackgroundColor",e))))),t},onEnable:e=>{const n=document.documentElement;e.buttonColor&&n.style.setProperty("--color-base-content",e.buttonColor),e.buttonBackgroundColor&&n.style.setProperty("--color-base-200",e.buttonBackgroundColor),e.primaryButtonColor&&n.style.setProperty("--color-primary",e.primaryButtonColor),e.primaryFontColor&&n.style.setProperty("--color-primary-content",e.primaryFontColor),e.levelColor&&n.style.setProperty("--color-secondary",e.levelColor),e.uiBackgroundColor&&n.style.setProperty("--color-base-100",e.uiBackgroundColor),e.uiSecondaryBackgroundColor&&n.style.setProperty("--color-base-300",e.uiSecondaryBackgroundColor)},onDisable:()=>{const e=document.documentElement;e.style.removeProperty("--color-base-content"),e.style.removeProperty("--color-base-200"),e.style.removeProperty("--color-primary"),e.style.removeProperty("--color-primary-content"),e.style.removeProperty("--color-secondary"),e.style.removeProperty("--color-base-100"),e.style.removeProperty("--color-base-300")}}),t.register({id:"font_changer",name:"Font Changer",description:"Change the display font of the interface.",defaultConfig:{selectedFont:"default"},renderSettings:(e,n)=>{const t=document.createElement("div");return t.appendChild(o.row("Select Font",o.select(e.selectedFont,[{value:"default",label:"Default"},{value:"Pixelify Sans",label:"Pixelify Sans„Éªüá∫üá∏"}],(e=>n("selectedFont",e))))),t},onEnable:e=>{const n="zenith-font-style";let t=document.getElementById(n);t||(t=document.createElement("style"),t.id=n,document.head.appendChild(t)),"Pixelify Sans"===e.selectedFont?t.textContent="\n                @import url('https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&display=swap');\n                \n                *, *::before, *::after {\n                    font-family: 'Pixelify Sans', sans-serif !important;\n                }\n            ":t.textContent=""},onDisable:()=>{const e=document.getElementById("zenith-font-style");e&&(e.textContent="")}}),t.register({id:"rainbow_module",name:"Rainbow",description:"Apply rainbow effects to levels and names.",defaultConfig:{levelColor:!1,nameColor:!1},observer:null,renderSettings:(e,n)=>{const t=document.createElement("div");return t.appendChild(o.row("Rainbow Level Color",o.switch(e.levelColor,(e=>n("levelColor",e))))),t.appendChild(o.row("Rainbow Name Color",o.switch(e.nameColor,(e=>n("nameColor",e))))),t},onEnable:e=>{const n="zenith-rainbow-styles";let t=document.getElementById(n);t||(t=document.createElement("style"),t.id=n,document.head.appendChild(t));let o=[];if(e.nameColor){const e=[".text-lime-500",".text-red-50",".text-red-300",".text-red-400",".text-red-500",".text-red-600",".text-orange-500",".text-amber-200",".text-amber-300",".text-amber-500",".text-amber-600",".text-yellow-400",".text-yellow-500",".text-green-100",".text-green-500",".text-green-600",".text-emerald-500",".text-teal-500",".text-cyan-500",".text-cyan-600",".text-sky-500",".text-blue-500",".text-blue-800",".text-indigo-500",".text-violet-500",".text-purple-500",".text-fuchsia-500",".text-pink-500",".text-rose-500"].join(",\n");o.push(`\n                    ${e} {\n                        background: linear-gradient(270deg, red, orange, yellow, green, blue, indigo, violet);\n                        background-size: 1400% 1400%;\n                        -webkit-background-clip: text;\n                        -webkit-text-fill-color: transparent;\n                        animation: rainbowShift 10s ease infinite;\n                    }\n                    @keyframes rainbowShift {\n                        0% { background-position: 0% 50%; }\n                        50% { background-position: 100% 50%; }\n                        100% { background-position: 0% 50%; }\n                    }\n                `)}e.levelColor&&o.push("\n        .level-fill.center-absolute.absolute.size-12.rotate-\\[215deg\\].rounded-full.svelte-12f880g {\n            background: conic-gradient(rgb(255, 133, 133) 0deg, rgb(246, 216, 134) 30deg, rgb(255, 255, 163) 60deg, rgb(149, 255, 149) 90deg, rgb(152, 255, 255) 120deg, rgb(160, 160, 254) 150deg, rgb(245, 172, 245) var(--angle), transparent calc(var(--angle) + 1deg) 360deg) !important;\n        }\n            "),t.textContent=o.join("\n")},onDisable:()=>{const e=document.getElementById("zenith-rainbow-styles");e&&(e.textContent="")}}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s()}();